<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Invitación de Cumpleaños</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="invitation">
  <div class="header">
    <h1>¡Estás Invitado!</h1>
    <p>¡Únete a nosotros para celebrar un día especial!</p>
  </div>
  <div class="userData">
    <h2>Datos del Invitado</h2>
    <div id="userData"></div>
  </div>
  <div class="footer">
    <button id="shareButton">Compartir por WhatsApp</button>
  </div>
</div>

<script>
window.onload = function() {
  // Obtener los parámetros de la URL
  var urlParams = new URLSearchParams(window.location.search);
  var userDataString = urlParams.get('data');
  
  // Decodificar los datos del usuario
  var userData = JSON.parse(decodeURIComponent(userDataString));

  // Calcular la hora de finalización del cumpleaños (2 horas después de la hora de inicio)
  var startTime = new Date("2000-01-01T" + userData.time + ":00");
  var endTime = new Date(startTime.getTime() + 2 * 60 * 60 * 1000);
  var endTimeFormatted = ('0' + endTime.getHours()).slice(-2) + ':' + ('0' + endTime.getMinutes()).slice(-2);

  // Mostrar los datos en la página
  var userDataElement = document.getElementById('userData');
  userDataElement.innerHTML = "<p><strong>Nombre:</strong> " + userData.name + "</p>" +
                               "<p><strong>Fecha de Cumpleaños:</strong> " + userData.birthday + "</p>" +
                               "<p><strong>Hora de Inicio del Cumpleaños:</strong> " + userData.time + "</p>" +
                               "<p><strong>Hora de Finalización del Cumpleaños:</strong> " + endTimeFormatted + "</p>";

  // Botón para compartir por WhatsApp
  var shareButton = document.getElementById('shareButton');
  shareButton.addEventListener('click', function() {
    var encodedUserData = encodeURIComponent(JSON.stringify(userData));
    var pageURLWithData = "whatsapp://send?text=" + encodeURIComponent(window.location.href.split('?')[0] + '?data=' + encodedUserData);
    window.open(pageURLWithData);
  });
}
</script>

</body>
</html>